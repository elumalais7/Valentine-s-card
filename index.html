<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Cinematic</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins}
body,html{
height:100%;
overflow:hidden;
background:#000;
color:#fff;
}
/* ---------- MAIN SPLIT LAYOUT ---------- */
.split{
display:flex;
height:100vh;      /* full screen height */
width:100%;
}

.left{
flex:1;
position:relative;
overflow:hidden;
}

.right{
flex:1;
display:flex;
align-items:center;     /* vertical center */
justify-content:center; /* horizontal center */
height:100%;
}

/* ---------- TITLE ---------- */
#title{
position:absolute;
top:20px;
width:100%;
text-align:center;
font-size:22px;
font-weight:600;
z-index:5;
}

/* ---------- LOGIN BOX ---------- */
.loginBox{
width:85%;
max-width:340px;
padding:25px;
border-radius:12px;
background:rgba(255,255,255,0.05);
backdrop-filter:blur(10px);
box-shadow:0 0 25px rgba(255,105,180,.4);

display:flex;
flex-direction:column;
gap:14px;
}

.loginBox input,
.loginBox select,
.loginBox textarea{
padding:10px;
border:none;
border-radius:6px;
outline:none;
font-size:14px;
}

.loginBox button{
padding:10px;
border:none;
border-radius:6px;
background:#ff4da6;
color:white;
font-weight:600;
}
/* ---------- HEARTS ---------- */
.hearts{position:absolute;width:100%;height:100%; pointer-events:none;}
.heart{
position:absolute;
font-size:20px;
animation:rise linear infinite;
}
@keyframes rise{
0%{transform:translateY(100vh);opacity:0}
50%{opacity:1}
100%{transform:translateY(-10vh);opacity:0}
}

/* LOGIN PAGE */
#loginPage{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
display:flex;
flex-direction:column;
background:#000;
z-index:2;
}

/* LETTER PAGE */
#letterPage{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:#000;

display:flex;
align-items:center;
justify-content:center;
flex-direction:column;

/* hide it completely before login */
opacity:0;
pointer-events:none;

/* prepare animation */
transform:rotateY(90deg);
transform-origin:left;

transition:transform 1s ease, opacity .6s ease;

z-index:3;

/* mobile fix */
backface-visibility:hidden;
-webkit-backface-visibility:hidden;
}
#letterPage.show{
opacity:1;
pointer-events:auto;
transform:rotateY(0deg);
}
/* ---------- ENVELOPE ---------- */
.envelope{
width:240px;height:160px;
background:linear-gradient(45deg,#ffb3d9,#ff66b3);
border-radius:10px;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
cursor:pointer;
box-shadow:0 0 20px #ff66b3;
}

.seal{font-size:30px}
.touch{font-size:12px}

/* ---------- LETTER ---------- */
#letter{
display:none;
background:#ffc0cb;
color:#000;
width:90%;
max-width:600px;
border-radius:12px;
padding:25px;
margin-top:20px;

box-shadow:0 0 30px rgba(255,105,180,.7);
line-height:1.6;
font-size:16px;
}
#downloadBtn{margin-top:15px}

/* burst */
@keyframes burst{
0%{transform:scale(1)}
50%{transform:scale(1.3)}
100%{transform:scale(1)}
}
.burst{animation:burst .6s}
@media(max-width:768px){

.split{
flex-direction:column;
}

.left{
height:40vh;
}

.right{
height:60vh;
align-items:center;
justify-content:center;
}

}

}
</style>
</head>

<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
<div id="title">Valentine Portal üíï</div>

<div class="split">
<div class="left"><div class="hearts" id="h1"></div></div>

<div class="right">
<div class="loginBox">
<h3>Welcome</h3>
<input id="name" placeholder="Enter your Name">

<select id="relation">
<option value="">Relationship</option>
<option>Friend/Classmate</option>
<option>Family</option>
<option>Teacher</option>
<option>Crush</option>
<option>Others</option>
</select>

<textarea id="otherBox" placeholder="Describe..." style="display:none"></textarea>

<button onclick="login()">Login</button>
</div>
</div>
</div>
</div>


<!-- LETTER PAGE -->
<div id="letterPage">
<div class="hearts" id="h2"></div>

<div class="envelope" onclick="openLetter()">
<div id="coverText"></div>
<div class="seal">üíù</div>
<div class="touch">touch me</div>
</div>

<div id="letter">
<div id="content"></div>
<button id="downloadBtn" onclick="downloadLetter()">Download Letter</button>
</div>
</div>


<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, addDoc, collection }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyB0_qEK0CnxZZkPk9OlNJlxKOlN1SZnatw",
authDomain:"valentines-card-63039.firebaseapp.com",
projectId:"valentines-card-63039"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

/* GLOBAL SAFE SAVE */
window.saveData = async (n,r)=>{

    if(!db){
        console.log("Firestore not ready");
        return;
    }

    try{
        const docRef = await addDoc(
            collection(db,"logins"),
            {
                name:n,
                relation:r,
                time:new Date().toISOString()
            }
        );

        console.log("Saved ID:", docRef.id);

    }catch(err){
        console.error("Save error:", err);
    }
};
</script>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>

/* hearts generator */
function hearts(target){
setInterval(()=>{
let h=document.createElement("div");
h.className="heart";
h.innerText="üíï";
h.style.left=Math.random()*100+"%";
h.style.animationDuration=(3+Math.random()*3)+"s";
target.appendChild(h);
setTimeout(()=>h.remove(),6000);
},200);
}
hearts(h1);
hearts(h2);

/* relation */
relation.onchange=()=>{
otherBox.style.display=
relation.value==="Others"?"block":"none";
};

let username="",rel="";

/* LOGIN */
function login(){

// Get values safely
const nameInput = document.getElementById("name");
const relationSelect = document.getElementById("relation");
const otherInput = document.getElementById("otherBox");

username = nameInput.value.trim();
rel = relationSelect.value;

if(rel === "Others"){
    rel = otherInput.value.trim();
}

if(!username || !rel){
    alert("Fill all fields");
    return;
}
saveData(username, rel)
  .then(()=>alert("Saved to Firebase"))
  .catch(()=>alert("Not saved"));

/* ‚≠ê ALWAYS SHOW NEXT PAGE FIRST */
/* SHOW NEXT PAGE */
const page = document.getElementById("letterPage");
const cover = document.getElementById("coverText");
const loginPg = document.getElementById("loginPage");

cover.innerHTML = `Thank you<br>‚ô° ${username} ‚ô°`;
page.classList.add("show");

/* smooth hide after animation */
setTimeout(()=>{
loginPg.style.display="none";
},600);
/* ‚≠ê SAFE FIREBASE CALL (won't break UI) */
if(typeof saveData === "function"){
    try{
        saveData(username, rel);
    }catch(e){
        console.log("Firebase skipped:", e);
    }
}

}

/* open envelope */
function openLetter(){
document.querySelector(".envelope").style.display="none";
letter.style.display="block";
typeLetter();
}

/* message selection */
function message(){
switch(rel){
case "Friend/Classmate":
return `Dear ${username}...‚ô°,

Sub: Friendship

"To my awesome friends and classmates...On this Valentine's Day, may your hearts be filled with laughter, your bonds unbreakable, and your adventures endless. You're the real MVPs! üíï"
~colleague Elumalai S`;

case "Family":
return `Dear ${username}...‚ô°,

Sub: Family Love

"To my beloved family and relatives...This Valentine's Day, I look back at the stories we've shared‚Äîthe feasts, the travels, the quiet moments that built our legacy of love. Here's to many more chapters together! üåü‚ù§Ô∏è"
~Beloved Elumalai S`;

case "Teacher":
return `Dear ${username}...‚ô°,

Sub: Gratitude

"To my inspiring teacher...On this Valentine's Day, thank you for igniting curiosity, shaping minds, and filling our days with knowledge and kindness. You're the guiding light we cherish! üìö‚ù§Ô∏è"
~Elumalai S`;

case "Crush":
return `Dear ${username}...‚ô°,

"‡Æâ‡Æ©‡Øç‡Æ©‡Øà ‡Æ®‡Ææ‡Æ©‡Øç ‡Æï‡Ææ‡Æ§‡Æ≤‡Æø‡Æ§‡Øç‡Æ§‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡Æ®‡Ææ‡Æ≥‡Æø‡Æ≤‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‚Ä¶ ‡Æí‡Æµ‡Øç‡Æµ‡Øä‡Æ∞‡ØÅ ‡Æ™‡Ææ‡Æ∞‡Øç‡Æµ‡Øà‡ÆØ‡Æø‡Æ≤‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æï...‡Æö‡Øä‡Æ≤‡Øç‡Æ≤‡Æ§‡Øç ‡Æ§‡ØÅ‡Æ£‡Æø‡ÆØ‡Ææ‡Æ§ ‡Æá‡Æ®‡Øç‡Æ§ ‡Æï‡Ææ‡Æ§‡Æ≤‡Øç,‡Æé‡Æ©‡Øç ‡Æá‡Æ§‡ÆØ‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ§‡Æø‡Æ©‡ÆÆ‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡Æ≤‡Æ∞‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.‡Æö‡Øä‡Æ≤‡Øç‡Æ≤‡Ææ‡Æ§ ‡Æï‡Ææ‡Æ§‡Æ≤‡Øç ‡Æ§‡Ææ‡Æ©‡Øç ‡Æá‡Æ§‡ØÅ‚Ä¶‡Æâ‡Æ©‡Øç‡Æ©‡Øà ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æí‡Æµ‡Øç‡Æµ‡Øä‡Æ∞‡ØÅ ‡Æ®‡Øä‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç‡Æé‡Æ©‡Øç ‡Æá‡Æ§‡ÆØ‡ÆÆ‡Øç ‡ÆÆ‡ØÜ‡Æ§‡ØÅ‡Æµ‡Ææ‡Æï ‡Æâ‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà‡Æö‡Øç ‡Æö‡Øä‡Æ≤‡Øç‡Æ≤‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.‡Æ®‡ØÄ ‡ÆÖ‡Æ±‡Æø‡ÆØ‡Ææ‡ÆÆ‡Æ≤‡Øç‚Ä¶‡Æ®‡Ææ‡Æ©‡Øç ‡ÆÆ‡ØÅ‡Æ¥‡ØÅ‡Æµ‡Æ§‡ØÅ‡ÆÆ‡Øç ‡Æ®‡ØÄ‡ÆØ‡Ææ‡Æï‡Æø ‡Æµ‡Æø‡Æü‡Øç‡Æü‡Øá‡Æ©‡Øç..."
ü´∂...Will you be my üå∑valentineüåπ...ü´∂
~‡ÆÖ‡Æ©‡Øç‡Æ™‡ØÅ‡Æ≥‡Øç‡Æ≥ ‡Æï‡Ææ‡Æ§‡Æ≤‡Æ©‡Øç`;

default:
return `Dear ${username}...‚ô°,

"Happy Valentine‚Äôs Day!May your day be filled with love, laughter, and the warmth of people who care about you.Not all love is spoken ‚Äî some is found in friendships, smiles, and little moments.I am grateful to share these beautiful connections with you.I wish you happiness today and always."
~yours Lovely Els‚ô°`;
}
}

/* typing */
function typeLetter(){
let txt=message();
let i=0;
content.innerHTML="";
let t=setInterval(()=>{
content.innerHTML+=txt[i];
i++;
if(i>=txt.length) clearInterval(t);
},25);
}

/* download */
async function downloadLetter(){

    const element = document.getElementById("letter");

    /* Wait a frame so layout stabilizes */
    await new Promise(r => setTimeout(r, 300));

    html2canvas(element,{
        scale: 3,                // ‚≠ê HD Quality
        useCORS: true,
        backgroundColor: null,   // keeps colors clean
        scrollX: 0,
        scrollY: 0,
        windowWidth: document.body.scrollWidth,
        windowHeight: document.body.scrollHeight
    }).then(canvas=>{

        const link=document.createElement("a");
        link.download="Valentine_Letter.png";
        link.href=canvas.toDataURL("image/png",1.0);
        link.click();

        document.getElementById("downloadBtn")
            .classList.add("burst");
    });
}
</script>
</body>
</html>